# ANAL-03: Manifold-Aware Optimizer Comparison Report

**Generated:** 2026-01-22 20:22:44
**Status:** Pending Experiments

## Executive Summary

This report will compare ManifoldAdamW (geometry-aware optimizer) versus
standard AdamW on E5M2 format experiments.

**ManifoldAdamW benefit:** Pending - experiments not yet run

## Hypothesis

ManifoldAdamW should improve training stability and convergence on quantized
formats by:
1. Scaling gradients by local stiffness (inverse of ULP spacing)
2. Preventing updates smaller than quantization resolution
3. Adapting step sizes to the non-uniform FP8 grid

## Pending Experiments

Run both standard and ManifoldAdamW variants on E5M2:

| Config | Optimizer | use_manifold_aware |
|--------|-----------|-------------------|
| e5m2_short.yaml | AdamW | false |
| e5m2_manifold.yaml | ManifoldAdamW | true |

```bash
# Standard AdamW on E5M2
python experiments/run_experiment.py experiments/configs/e5m2_short.yaml

# ManifoldAdamW on E5M2
python experiments/run_experiment.py experiments/configs/e5m2_manifold.yaml

# Regenerate reports after experiments
python scripts/generate_reports.py --project <your-wandb-project>
```

## Expected Comparison Metrics

| Metric | Standard AdamW | ManifoldAdamW | Expected Improvement |
|--------|---------------|---------------|---------------------|
| best_loss | TBD | TBD | 5-15% lower |
| bit_stall_rate | TBD | TBD | 10-30% lower |
| completion_rate | TBD | TBD | Higher |

## Stiffness Preconditioning

ManifoldAdamW modifies the gradient update:

```python
# Standard AdamW
param = param - lr * grad

# ManifoldAdamW
stiffness = 1.0 / ulp_spacing(param)  # Inverse of quantization grid spacing
preconditioned_grad = grad * stiffness
param = param - lr * preconditioned_grad
```

This scales gradients inversely to the local grid spacing, giving larger
updates in dense regions (small ULPs) and smaller updates in sparse regions.

## W&B Run Links (after experiments)

Runs will be linked here for full traceability:
- Standard AdamW run: `wandb.ai/<entity>/<project>/runs/<run-id>`
- ManifoldAdamW run: `wandb.ai/<entity>/<project>/runs/<run-id>`

---
*Generated by altgrad.analysis.ReportGenerator (placeholder mode)*
